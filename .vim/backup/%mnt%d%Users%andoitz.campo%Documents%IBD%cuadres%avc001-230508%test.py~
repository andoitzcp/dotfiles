import pandas as pd
from alive_progress import alive_bar

# Data types specifications
datatypes = {'COMPANY': str,
          'CECO': str,
          'RCLASS': str,
          'BAREA': str,
          'PEP': str,
          'ENE': float,
          'FEB': float,
          'MAR': float,
          'ABR': float,
          'MAY': float,
          'JUN': float,
          'JUL': float,
          'AGO': float,
          'SEP': float,
          'OCT': float,
          'NOV': float,
          'DIC': float,
          'CTEST1': float,
          'CTEST2': float,
          'CTEST3': float,
          'CTEST4': float,
          'CTEST5': float}

df = pd.read_csv('export_sap_zlipt.csv', decimal=',',sep=';', dtype=datatypes)
print(df)
df['P'] = df[df.loc['RCLASS'] == '1', 'ENE':'DIC'].sum(axis=1)
print(df)
